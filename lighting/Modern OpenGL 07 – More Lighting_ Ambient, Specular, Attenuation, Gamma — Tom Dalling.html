<!DOCTYPE html>
<!-- saved from url=(0098)https://www.tomdalling.com/blog/modern-opengl/07-more-lighting-ambient-specular-attenuation-gamma/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>Modern OpenGL 07 – More Lighting: Ambient, Specular, Attenuation, Gamma — Tom Dalling</title>
    <link href="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/style.css" rel="stylesheet">
    <link rel="stylesheet" href="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/font-awesome.min.css">
    <link type="text/css" rel="stylesheet" href="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/css">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  <link rel="canonical" href="https://www.tomdalling.com/blog/modern-opengl/07-more-lighting-ambient-specular-attenuation-gamma/"><script async="" src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/analytics.js.下载"></script><script type="text/javascript" async="" src="https://tomdalling.disqus.com/embed.js"></script><script charset="utf-8" src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/button.e96bb6acc0f8bda511c0c46a84ee18e4.js.下载"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

  <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    <div class="container">

      <div class="row">
        <div class="col-md-12">
          <nav role="navigation" class="navbar navbar-default">
            <div class="container-fluid">
              <div class="navbar-header">
                <button data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" class="navbar-toggle" type="button">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a href="https://www.tomdalling.com/" class="navbar-brand">Tom Dalling</a>
              </div>

              <div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                  <li><a href="https://www.tomdalling.com/">Home</a></li>
                  <li><a href="https://www.tomdalling.com/blog/">Blog</a></li>
                </ul>
              </div>
            </div>
          </nav>
        </div>
      </div>

      <div class="row">

        <main class="col-md-8"><article class="post post-single">

  <header>
    <h1><a href="https://www.tomdalling.com/blog/modern-opengl/07-more-lighting-ambient-specular-attenuation-gamma/">Modern OpenGL 07 – More Lighting: Ambient, Specular, Attenuation, Gamma</a></h1>
    <small class="meta">
      <span class="post-date">18 Apr, 2013</span>
      —
      Category: <a href="https://www.tomdalling.com/blog/category/modern-opengl/" class="category">Modern OpenGL Series</a>
    </small>
    <div class="main-image">
      <img class="img-responsive" src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/main-image.png">
      
    </div>
  </header>

  <div class="post-content"><p>In this article we will continue to implement lighting. We will implement the ambient and specular components of the Phong reflection model, attenuation, and gamma correction.</p>
<!--more--><p></p><div class="modern-opengl-preamble">
  <h2>Accessing The Code</h2>

  <p>
    Download all the code as a zip from here:
    <a href="https://github.com/tomdalling/opengl-series/archive/master.zip">
      https://github.com/tomdalling/opengl-series/archive/master.zip
    </a>
  </p>

  <p>
    All the code in this series of articles is available from github:
    <a href="https://github.com/tomdalling/opengl-series">https://github.com/tomdalling/opengl-series</a>.
    You can download a zip of all the files from that page, or you can clone the
    repository if you are familiar with git.
  </p>

  <p class="builds-on-previous">
    This article builds on the code from the previous article.
  </p>

  <p>
    The code for this article can be found in the
    <a class="source_folder" href="https://github.com/tomdalling/opengl-series/tree/master/source/07_more_lighting">
      <code>source/07_more_lighting</code>
    </a>
    folder. On OS X, open the <code>opengl-series.xcodeproj</code> file in the
    root folder, and select the target that corresponds with this article. On
    Windows, open the <code>opengl-series.sln</code> file in Visual Studio 2013,
    and open the project that corresponds with this article.
  </p>

  <p>
    The project includes all of its dependencies, so you shouldn't have to
    install or configure anything extra. Please let me know if you have
    any issues compiling and running the code.
  </p>
</div><h2>Diffuse Component</h2><p>We covered the diffuse component in the previous article, but I've refactored the code in this article. The new GLSL looks like this:</p>
<div class="highlight"><pre><span class="k">vec3</span> <span class="n">normal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">transpose</span><span class="p">(</span><span class="n">inverse</span><span class="p">(</span><span class="k">mat3</span><span class="p">(</span><span class="n">model</span><span class="p">)))</span> <span class="o">*</span> <span class="n">fragNormal</span><span class="p">);</span>
<span class="k">vec3</span> <span class="n">surfacePos</span> <span class="o">=</span> <span class="k">vec3</span><span class="p">(</span><span class="n">model</span> <span class="o">*</span> <span class="k">vec4</span><span class="p">(</span><span class="n">fragVert</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
<span class="k">vec4</span> <span class="n">surfaceColor</span> <span class="o">=</span> <span class="n">texture</span><span class="p">(</span><span class="n">materialTex</span><span class="p">,</span> <span class="n">fragTexCoord</span><span class="p">);</span>
<span class="k">vec3</span> <span class="n">surfaceToLight</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">light</span><span class="p">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">surfacePos</span><span class="p">);</span>

<span class="k">float</span> <span class="n">diffuseCoefficient</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dot</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">surfaceToLight</span><span class="p">));</span>
<span class="k">vec3</span> <span class="n">diffuse</span> <span class="o">=</span> <span class="n">diffuseCoefficient</span> <span class="o">*</span> <span class="n">surfaceColor</span><span class="p">.</span><span class="n">rgb</span> <span class="o">*</span> <span class="n">light</span><span class="p">.</span><span class="n">intensities</span><span class="p">;</span>
</pre></div><p>The <code>diffuseCoefficient</code> was previously called <code>brightness</code>. It uses the <code>max</code> function instead of <code>clamp</code> to avoid negative values. </p><p>Also, because <code>normal</code> and <code>surfaceToLight</code> are both unit vectors, the dot product code was simplified from this:</p>
<div class="highlight"><pre><span class="n">dot</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">surfaceToLight</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span> <span class="o">*</span> <span class="n">length</span><span class="p">(</span><span class="n">surfaceToLight</span><span class="p">))</span>
</pre></div><p>down to this:</p>
<div class="highlight"><pre><span class="n">dot</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">surfaceToLight</span><span class="p">)</span>
</pre></div><h2>Ambient Component</h2><p></p><figure>  <img src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/800px-Phong_components_version_4.png">  <figcaption>  Image by <a href="http://en.wikipedia.org/wiki/File:Phong_components_version_4.png">Brad Smith</a>  </figcaption> </figure><p></p>
<blockquote class="pull-right">
  The ambient component of the Phong reflection model basically specifies a
  minimum brightness.
</blockquote><p>The ambient component of the Phong reflection model basically specifies a minimum brightness. Even if there is no light hitting a surface directly, the ambient component will light up the surface a little bit to stop it from being pure black. The ambient brightness is constant for all surfaces.</p><p>We will calculate the ambient component using a percentage of the original intensities of the light source. We will store this ambient percentage as a float with a value between zero (0%) and one (100%), in a variable named <code>ambientCoefficient</code>. For example if <code>ambientCoefficient</code> is 0.05 (5%) and the reflected light intensities are <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 3.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1003.02em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mo" id="MathJax-Span-3" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-4" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-5" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-6" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">(1, 0, 0)</script>, which is pure red light, then the ambient component will be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.05&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 5.315em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.43em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1004.33em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-13" style="font-family: MathJax_Main;">0.05</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0.05</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2">(0.05, 0, 0)</script>, which is very dim red light. </p><p>The GLSL to calculate the ambient component in the fragment shader looks like this:</p>
<div class="highlight"><pre><span class="k">vec3</span> <span class="n">ambient</span> <span class="o">=</span> <span class="n">light</span><span class="p">.</span><span class="n">ambientCoefficient</span> <span class="o">*</span> <span class="n">surfaceColor</span><span class="p">.</span><span class="n">rgb</span> <span class="o">*</span> <span class="n">light</span><span class="p">.</span><span class="n">intensities</span><span class="p">;</span>
</pre></div><p>This is the same as the diffuse component we implemented in the last article, except that we use <code>light.ambientCoefficient</code> instead of <code>brightness</code> (which is now called <code>diffuseCoefficient</code>).</p><h2>Specular Component</h2>
<blockquote class="pull-right">
  The specular component is what makes a surface look shiny.
</blockquote><p>The specular component is what makes a surface look shiny. The word "specular" means "like a mirror," and it is used here because the shiny patches (a.k.a. specular highlights) are fake reflections of light, like a mirror would reflect light.</p><p>Let's start by looking at how a mirror reflects light.</p><p></p><figure>  <img src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/mirror-surface.png"> </figure><p></p><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 1.096em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.89em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">N</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.47em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">I</script> are the normal and the angle of incidence (AoI), which we saw in the last article. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.78em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">R</script> is new, and it represents <em>the angle of reflection</em> (AoR). The angle of reflection is the angle between the reflected ray, and the surface normal. It is sort of the opposite of the angle of incidence.</p><p>When light hits a perfect mirror surface, the AoI and AoR are equal. That is, if light comes in at a 30° angle, it will be reflected at a 30° angle.</p><p></p><figure>  <img src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/perfect_mirror.png"> </figure><p></p><p>Now let's look at surfaces that do no behave like a perfect mirror.</p><p></p><figure>  <img src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/Diffuse_reflection.png">  <figcaption>  Image by <a href="http://en.wikipedia.org/wiki/File:Diffuse_reflection.PNG">Theresa Knott</a>  </figcaption> </figure><p></p><p>When light hits an irregular surface, like the one shown above, the light could be reflected in any direction. This is the difference between the diffuse and specular components: the diffuse component models irregular surfaces, and the specular component models mirror-like surfaces.</p><p>Many surfaces have both specular <em>and</em> diffuse components to them. The outer surface of a car is a good example. It's not a perfect mirror, but it can be shiny enough to see your reflection in it. This is because the surface has a layer of paint underneath a layer of clear topcoat. The paint layer is diffuse, but the topcoat layer is specular. The topcoat is also clear, so some of the light is reflected, but some of the light goes straight through to hit the paint layer beneath.</p><p></p><figure>  <img src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/specular_and_diffuse.png"> </figure><p></p>
<blockquote class="pull-right">
  The specular component is usually a different color to the diffuse component.
</blockquote><p>Notice how when the topcoat reflects light, the rays don't hit the paint layer. Normally the paint layer would change the color of the light by absorbing some of the intensities, but that can't happen if the light doesn't hit the paint. This means that the specular component is usually a different color to the diffuse component. Most specular surfaces don't absorb anything, they just reflect all of the light, which means the specular color would be white. This is why the shiny parts of a car are white, even though the paint is red.</p><p>To calculate the specular component, we basically solve this question: if the surface was a perfect mirror, would it be reflecting rays from the light source straight into the camera? To get the answer, we:</p>
<ul>
  <li>Calculate the <em>incidence vector</em>, which is a vector from the light to the surface.</li>
  <li>Calculate the <em>reflection vector</em>, based on the surface normal and the incidence vector, using the AoI = AoR rule.</li>
  <li>Calculate a vector from the surface to the camera.</li>
  <li>Get the angle between the reflection vector and the surface-to-camera vector.</li>
  <li>If the angle is small, then we conclude that, yes, the light <em>is</em> being reflected straight into the camera.</li>
</ul><p>Just like the diffuse component, we won't actually calculate the angle. We will just use <code>cos(angle)</code> instead, because it ranges from zero to one, which is more useful.</p><p>How small does the angle have to be? Well that depends on how shiny the surface is. We need a variable to represent shininess, and this variable is called the "specular exponent." The larger the specular exponent, the more shiny the surface will be. It's up to the artist to play around with this value, until it looks right.</p><p>To apply the specular exponent, we take <code>cos(angle)</code> and raise it to the power of the specular exponent. This produces the "specular coefficient", which is the brightness of the reflection.</p><p></p><figure>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 7.086em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.888em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.513em, 1005.89em, 2.815em, -999.997em); top: -2.393em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">c</span><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">θ</span><span class="msubsup" id="MathJax-Span-37"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.32em, 4.43em, -999.997em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="texatom" id="MathJax-Span-39"><span class="mrow" id="MathJax-Span-40"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.398em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>s</mi></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">  x = cos(\theta)^{s}  </script>  <figcaption>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 0.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.58em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.542em, 1000.52em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">x</script> is the specular coefficient<br>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-45" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.452em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.285em, 1000.45em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">\theta</script> is the angle<br>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-48" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.452em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.542em, 1000.39em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">s</script> is the specular exponent  </figcaption> </figure><p></p><p>We will use a GLSL uniform variable called <code>materialShininess</code> to hold the specular exponent. The GLSL to calculate the entire specular component looks like this:</p>
<div class="highlight"><pre><span class="k">vec3</span> <span class="n">incidenceVector</span> <span class="o">=</span> <span class="o">-</span><span class="n">surfaceToLight</span><span class="p">;</span> <span class="c1">//a unit vector</span>
<span class="k">vec3</span> <span class="n">reflectionVector</span> <span class="o">=</span> <span class="n">reflect</span><span class="p">(</span><span class="n">incidenceVector</span><span class="p">,</span> <span class="n">normal</span><span class="p">);</span> <span class="c1">//also a unit vector</span>
<span class="k">vec3</span> <span class="n">surfaceToCamera</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">cameraPosition</span> <span class="o">-</span> <span class="n">surfacePosition</span><span class="p">);</span> <span class="c1">//also a unit vector</span>
<span class="k">float</span> <span class="n">cosAngle</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dot</span><span class="p">(</span><span class="n">surfaceToCamera</span><span class="p">,</span> <span class="n">reflectionVector</span><span class="p">));</span>
<span class="k">float</span> <span class="n">specularCoefficient</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="n">cosAngle</span><span class="p">,</span> <span class="n">materialShininess</span><span class="p">);</span>

<span class="k">vec3</span> <span class="n">specularComponent</span> <span class="o">=</span> <span class="n">specularCoefficient</span> <span class="o">*</span> <span class="n">materialSpecularColor</span> <span class="o">*</span> <span class="n">light</span><span class="p">.</span><span class="n">intensities</span><span class="p">;</span>
</pre></div><p>The <code>incidenceVector</code> is pointing from the light to the surface, which is the opposite direction of <code>surfaceToLight</code>. There is a GLSL function called <code>reflect</code> which calculates the reflection vector based on the surface normal and the incidence vector, using the AoI = AoR rule. We calculate <code>surfaceToCamera</code> using vector subtraction, and make it a unit vector with <code>normalize</code>. We then use the dot product to calculate <code>cosAngle</code>, as described in the previous article. Then, we calculate <code>specularCoefficient</code> by raising <code>cosAngle</code> to the power of the <code>materialShininess</code> (the specular exponent). </p><p>Lastly, we get the whole specular component by multiplying the specular coefficient by the material's specular color and the light intensities. This is very similar to the diffuse and ambient components, except we use <code>materialSpecularColor</code> instead of getting the surface color from a texture.</p><p>In the GLSL code for this article, we actually use a condensed version of the code above. Here is the actual code from the fragment shader:</p>
<div class="highlight"><pre><span class="k">float</span> <span class="n">specularCoefficient</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="n">diffuseCoefficient</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">specularCoefficient</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dot</span><span class="p">(</span><span class="n">surfaceToCamera</span><span class="p">,</span> <span class="n">reflect</span><span class="p">(</span><span class="o">-</span><span class="n">surfaceToLight</span><span class="p">,</span> <span class="n">normal</span><span class="p">))),</span> <span class="n">materialShininess</span><span class="p">);</span>
<span class="k">vec3</span> <span class="n">specular</span> <span class="o">=</span> <span class="n">specularCoefficient</span> <span class="o">*</span> <span class="n">materialSpecularColor</span> <span class="o">*</span> <span class="n">light</span><span class="p">.</span><span class="n">intensities</span><span class="p">;</span>
</pre></div><p>Notice the test for <code>diffuseCoefficient &gt; 0.0</code>. This is necessary because the <code>reflect</code> function will reflect the incidence vector off the front <em>and the back</em> of a surface. The back sides of a surface don't receive any light, so they can't be shiny at all. The <code>diffuseCoefficient</code> will be equal to zero if the surface is facing away from the light, so we check that first before calculating the specular coefficient.</p><h2>Attenuation</h2><p>In the code for the previous article, moving the light source away from the wooden crate didn't make the crate appear any darker. This is obviously wrong, because if you move a candle away from a surface in real life, then the surface gets darker. To fix this, we will implement attenuation. To see attenuation in action, hold down the <kbd>1</kbd> key, which sets the position of the light, and move the camera further away from the wooden crates. If you do the same thing in the previous article, you will notice that the surface doesn't get darker, but it does in this article.</p>
<blockquote class="pull-right">
  Attenuation is the loss of light intensity over distance. The greater the
  distance, the lower the intensity.
</blockquote><p>Attenuation is the loss of light intensity over distance. The greater the distance, the lower the intensity. We will represent attenuation as a percentage of remaining light, in a float with a value between zero and one. For example, an attenuation value of 0.2 means that 80% of the light intensity has been lost, and only 20% of the intensity remains. </p><p>In the real world, attenuation is proportional to the inverse of the distance squared:</p><p></p><figure>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x221D;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-51" style="width: 4.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.888em, 1003.6em, 3.284em, -999.997em); top: -2.393em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.263em;">∝</span><span class="mfrac" id="MathJax-Span-55" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-56" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1000.99em, 4.169em, -999.997em); top: -3.279em; left: 50%; margin-left: -0.518em;"><span class="msubsup" id="MathJax-Span-57"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.32em; left: 0.576em;"><span class="mn" id="MathJax-Span-59" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1001.15em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.148em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.398em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>i</mi><mo>∝</mo><mfrac><mn>1</mn><msup><mi>d</mi><mn>2</mn></msup></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">  i \propto \frac{1}{d^2}  </script>  <figcaption>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-60" style="width: 0.388em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.324em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.349em, 1000.26em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-61"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">i</script> is the intensity<br>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-63" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.516em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.285em, 1000.52em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">d</script> is the distance  </figcaption> </figure><p></p><p>We'll use a modified version of this formula. Firstly, we want to avoid divide-by-zero errors if the distance is zero, so we modify the formula slightly to get this:</p><p></p><figure>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-66" style="width: 7.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.836em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.888em, 1005.84em, 3.388em, -999.997em); top: -2.393em; left: 0em;"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mfrac" id="MathJax-Span-70" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 2.815em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-71" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1002.71em, 4.273em, -999.997em); top: -3.279em; left: 50%; margin-left: -1.352em;"><span class="mrow" id="MathJax-Span-72"><span class="mn" id="MathJax-Span-73" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="msubsup" id="MathJax-Span-75" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.32em; left: 0.576em;"><span class="mn" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1002.82em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.815em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.398em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>d</mi><mn>2</mn></msup></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">  a = \frac{1}{1 + d^2}  </script>  <figcaption>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-78" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.516em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.542em, 1000.52em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">a</script> is the attenuation<br>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.516em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.285em, 1000.52em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">d</script> is the distance  </figcaption> </figure><p></p><p>Now, if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-84" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-85"><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">d</script> is zero, then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-87" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-88"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">a</script> will be 1, which means that the light is at maximum intensity.</p><p>Secondly, we might want to control how fast the intensity decreases over distance. Maybe we want some lights to shine over very long distances without much attenuation, and other lights to only shine short distances with lots of attenuation. To control the attenuation we will add a variable, which we will just call <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-90" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-91"><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">k</script>:</p><p></p><figure>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-93" style="width: 7.763em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.888em, 1006.46em, 3.388em, -999.997em); top: -2.393em; left: 0em;"><span class="mrow" id="MathJax-Span-94"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mfrac" id="MathJax-Span-97" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-98" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1003.23em, 4.273em, -999.997em); top: -3.279em; left: 50%; margin-left: -1.612em;"><span class="mrow" id="MathJax-Span-99"><span class="mn" id="MathJax-Span-100" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">k</span><span class="msubsup" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.32em; left: 0.576em;"><span class="mn" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1003.34em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.336em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.398em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>k</mi><msup><mi>d</mi><mn>2</mn></msup></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">  a = \frac{1}{1 + kd^2}  </script>  <figcaption>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-106" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.516em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.542em, 1000.52em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">a</script> is the attenuation<br>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-109" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.516em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.285em, 1000.52em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-110"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">d</script> is the distance<br>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-112" style="width: 0.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.516em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.285em, 1000.52em, 2.375em, -999.997em); top: -2.176em; left: 0em;"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.183em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">k</script> is an arbitrary "attenuation factor"  </figcaption> </figure><p></p><p>The formula above, implemented in our fragment shader, looks like this:</p>
<div class="highlight"><pre><span class="k">float</span> <span class="n">attenuation</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">light</span><span class="p">.</span><span class="n">attenuation</span> <span class="o">*</span> <span class="n">pow</span><span class="p">(</span><span class="n">distanceToLight</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
</pre></div><p>The <code>light.attenuation</code> variable is the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">k</script> in the formula above.</p><p>We will apply attenuation to the diffuse and specular components, but not the ambient component. Remember that the ambient component is a constant minimum brightness, so it doesn't make sense to lower the brightness below the minimum.</p><p>The GLSL to combine the ambient, diffuse and specular components, including attenuation, looks like this:</p>
<div class="highlight"><pre><span class="k">vec3</span> <span class="n">linearColor</span> <span class="o">=</span> <span class="n">ambient</span> <span class="o">+</span> <span class="n">attenuation</span><span class="o">*</span><span class="p">(</span><span class="n">diffuse</span> <span class="o">+</span> <span class="n">specular</span><span class="p">);</span>
</pre></div><p>This is almost the final color for the fragment/pixel. The last step is to do gamma correction.</p><h2>Gamma Correction</h2><p>All of our lighting calculations so far have assumed that we are working a <em>linear color space</em>. In a linear color space, if you double one of the RGB color values, then the pixel on the screen should be twice as bright. For example, the 100% red color <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 3.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1003.02em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-121" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-125" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">(1,0,0)</script> should be twice as bright as the 50% red color <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-127" style="width: 4.69em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1003.8em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-128"><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-130" style="font-family: MathJax_Main;">0.5</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0.5</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">(0.5,0,0)</script>.</p><p>The problem is that computer screens do <em>not</em> display colors in a linear color space. The 100% red is actually about 4.5 times brighter than the 50% red, which makes the brightness in the 3D scene look wrong. This is because computer monitors mimic the way that old CRT monitors behaved. I've also read that it has nothing to do with CRT monitors, and it's necessary because of the way that the human eye perceives brightness. Either way, gamma correction will allow us to adjust the brightness of the 3D scene to make it look better.</p><p></p><figure>  <img src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/gamma_correction.png"> </figure><p></p><p>Th dotted line in the middle represents the linear color space we are working in. The solid line at the bottom represents the color space that computer monitors display. Notice how 0.5 on the dotted line matches up to 0.218 on the solid line. This means that if we calculate an RGB value of 0.5, it will actually look like 0.218 when it gets displayed on the monitor, so everything would look too dark. The dashed line at the top represents an RGB value after it has been gamma corrected, which increases the brightness. The gamma corrected color is too bright, and the monitor is too dark, so when they are combined the result looks correct.</p><p>Also notice how the lines meet up at zero and one. This means that gamma correction doesn't affect maximum and minimum brightness – it affects all the shades of brightness in the middle.</p>
<blockquote class="pull-right">
  Gamma correction is an operation that changes the brightness of an RGB color.
</blockquote><p>Gamma correction is an operation that changes the brightness of an RGB color. We do all our lighting calculations in linear colorspace, then we do gamma correction to adjust the color before it gets displayed on the screen. This makes all the lighting look correct, instead of looking too dark.</p><p>Gamma correction is pretty simple to implement. You take each of the RGB values and raise them to the power of <em>gamma</em>. Some games give the user a brightness setting which allows them to change the gamma value, but we will just use the constant value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2.2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" style="width: 1.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1001.25em, 2.659em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="mfrac" id="MathJax-Span-138"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.388em, 1000.32em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;"><span class="mn" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.89em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.466em;"><span class="mn" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Main;">2.2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1001.04em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.044em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mn>2.2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-26">\frac{1}{2.2}</script> in this article, which is the correct value for CRT monitors.</p><p>We will do gamma correction using the GLSL function <code>pow</code>. The GLSL looks something like this:</p>
<div class="highlight"><pre><span class="k">vec3</span> <span class="n">gamma</span> <span class="o">=</span> <span class="k">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">2.2</span><span class="p">);</span>
<span class="n">finalColor</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="n">linearColor</span><span class="p">,</span> <span class="n">gamma</span><span class="p">);</span>
</pre></div><p>The <code>pow</code> function raises the first argument to the power of the second argument. It can take numbers or vectors as arguments. If the arguments are vectors, it raises each element of the first vector to each element of the second vector. The code above is just a shorter way of writing this:</p>
<div class="highlight"><pre><span class="k">vec3</span> <span class="n">gamma</span> <span class="o">=</span> <span class="k">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">2.2</span><span class="p">);</span>
<span class="n">finalColor</span> <span class="o">=</span> <span class="k">vec3</span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">linearColor</span><span class="p">.</span><span class="n">r</span><span class="p">,</span> <span class="n">gamma</span><span class="p">.</span><span class="n">r</span><span class="p">),</span>
                  <span class="n">pow</span><span class="p">(</span><span class="n">linearColor</span><span class="p">.</span><span class="n">g</span><span class="p">,</span> <span class="n">gamma</span><span class="p">.</span><span class="n">g</span><span class="p">),</span>
                  <span class="n">pow</span><span class="p">(</span><span class="n">linearColor</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">gamma</span><span class="p">.</span><span class="n">b</span><span class="p">));</span>
</pre></div><p>It takes the red, green, and blue components of the <code>linearColor</code> vector, and raises them all to the power of <code>1.0/2.2</code>.</p><p>After implementing gamma correction and running the program, it actually looks too bright.</p><p></p><figure>  <img src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/double_gamma.jpg"> </figure><p></p>
<blockquote class="pull-right">
  Most image file formats already contain gamma-corrected RGB values.
</blockquote><p>The gamma-corrected image looks wrong, but the correct image looks like the one from the last article, which didn't have any gamma correction. This is because we're actually doing gamma correction <em>twice</em>. That's right, we already had some form of gamma correction before this article. Most image file formats already contain gamma-corrected RGB values. The <code>wooden-crate.jpg</code> file that we use as a texture is already gamma-corrected, and then we gamma-correct it a second time which makes it look too bright. We could just not implement gamma correction, which would make the textures look right, but then the lighting would look wrong. </p><p>We will just undo the gamma correction on the texture when we load it. Thankfully, this is very simple to do in OpenGL. Like most images, our the wooden crate image is in the <a href="http://en.wikipedia.org/wiki/SRGB">sRGB color space</a>, which is already gamma corrected. We can change the <code>internalFormat</code> argument of <a href="http://www.opengl.org/sdk/docs/man/xhtml/glTexImage2D.xml">glTexImage2D</a> to tell OpenGL that the texture data is already in the sRGB color space, and OpenGL will automatically un-correct the pixels into linear color space. For RGB pixel data, we change the <code>internalFormat</code> from <code>GL_RGB</code> to <code>GL_SRGB</code>. For RGBA pixel data, we change it from <code>GL_RGBA</code> into <code>GL_SRGB_ALPHA</code>. After making this change to <code>tdogl::Texture</code> class, the 3D scene looks correct again.</p><h2>Fragment Shader Code Changes</h2><p>Here is the entire fragment shader:</p>
<div class="highlight"><pre><span class="cp">#version 150</span>

<span class="k">uniform</span> <span class="k">mat4</span> <span class="n">model</span><span class="p">;</span>
<span class="k">uniform</span> <span class="k">vec3</span> <span class="n">cameraPosition</span><span class="p">;</span>

<span class="c1">// material settings</span>
<span class="k">uniform</span> <span class="k">sampler2D</span> <span class="n">materialTex</span><span class="p">;</span>
<span class="k">uniform</span> <span class="k">float</span> <span class="n">materialShininess</span><span class="p">;</span>
<span class="k">uniform</span> <span class="k">vec3</span> <span class="n">materialSpecularColor</span><span class="p">;</span>

<span class="k">uniform</span> <span class="k">struct</span> <span class="n">Light</span> <span class="p">{</span>
   <span class="k">vec3</span> <span class="n">position</span><span class="p">;</span>
   <span class="k">vec3</span> <span class="n">intensities</span><span class="p">;</span> <span class="c1">//a.k.a the color of the light</span>
   <span class="k">float</span> <span class="n">attenuation</span><span class="p">;</span>
   <span class="k">float</span> <span class="n">ambientCoefficient</span><span class="p">;</span>
<span class="p">}</span> <span class="n">light</span><span class="p">;</span>

<span class="k">in</span> <span class="k">vec2</span> <span class="n">fragTexCoord</span><span class="p">;</span>
<span class="k">in</span> <span class="k">vec3</span> <span class="n">fragNormal</span><span class="p">;</span>
<span class="k">in</span> <span class="k">vec3</span> <span class="n">fragVert</span><span class="p">;</span>

<span class="k">out</span> <span class="k">vec4</span> <span class="n">finalColor</span><span class="p">;</span>

<span class="k">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">vec3</span> <span class="n">normal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">transpose</span><span class="p">(</span><span class="n">inverse</span><span class="p">(</span><span class="k">mat3</span><span class="p">(</span><span class="n">model</span><span class="p">)))</span> <span class="o">*</span> <span class="n">fragNormal</span><span class="p">);</span>
    <span class="k">vec3</span> <span class="n">surfacePos</span> <span class="o">=</span> <span class="k">vec3</span><span class="p">(</span><span class="n">model</span> <span class="o">*</span> <span class="k">vec4</span><span class="p">(</span><span class="n">fragVert</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="k">vec4</span> <span class="n">surfaceColor</span> <span class="o">=</span> <span class="n">texture</span><span class="p">(</span><span class="n">materialTex</span><span class="p">,</span> <span class="n">fragTexCoord</span><span class="p">);</span>
    <span class="k">vec3</span> <span class="n">surfaceToLight</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">light</span><span class="p">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">surfacePos</span><span class="p">);</span>
    <span class="k">vec3</span> <span class="n">surfaceToCamera</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">cameraPosition</span> <span class="o">-</span> <span class="n">surfacePos</span><span class="p">);</span>
    
    <span class="c1">//ambient</span>
    <span class="k">vec3</span> <span class="n">ambient</span> <span class="o">=</span> <span class="n">light</span><span class="p">.</span><span class="n">ambientCoefficient</span> <span class="o">*</span> <span class="n">surfaceColor</span><span class="p">.</span><span class="n">rgb</span> <span class="o">*</span> <span class="n">light</span><span class="p">.</span><span class="n">intensities</span><span class="p">;</span>

    <span class="c1">//diffuse</span>
    <span class="k">float</span> <span class="n">diffuseCoefficient</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dot</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">surfaceToLight</span><span class="p">));</span>
    <span class="k">vec3</span> <span class="n">diffuse</span> <span class="o">=</span> <span class="n">diffuseCoefficient</span> <span class="o">*</span> <span class="n">surfaceColor</span><span class="p">.</span><span class="n">rgb</span> <span class="o">*</span> <span class="n">light</span><span class="p">.</span><span class="n">intensities</span><span class="p">;</span>
    
    <span class="c1">//specular</span>
    <span class="k">float</span> <span class="n">specularCoefficient</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">diffuseCoefficient</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">specularCoefficient</span> <span class="o">=</span> <span class="n">pow</span><span class="p">(</span><span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dot</span><span class="p">(</span><span class="n">surfaceToCamera</span><span class="p">,</span> <span class="n">reflect</span><span class="p">(</span><span class="o">-</span><span class="n">surfaceToLight</span><span class="p">,</span> <span class="n">normal</span><span class="p">))),</span> <span class="n">materialShininess</span><span class="p">);</span>
    <span class="k">vec3</span> <span class="n">specular</span> <span class="o">=</span> <span class="n">specularCoefficient</span> <span class="o">*</span> <span class="n">materialSpecularColor</span> <span class="o">*</span> <span class="n">light</span><span class="p">.</span><span class="n">intensities</span><span class="p">;</span>
    
    <span class="c1">//attenuation</span>
    <span class="k">float</span> <span class="n">distanceToLight</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">light</span><span class="p">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">surfacePos</span><span class="p">);</span>
    <span class="k">float</span> <span class="n">attenuation</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">light</span><span class="p">.</span><span class="n">attenuation</span> <span class="o">*</span> <span class="n">pow</span><span class="p">(</span><span class="n">distanceToLight</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>

    <span class="c1">//linear color (color before gamma correction)</span>
    <span class="k">vec3</span> <span class="n">linearColor</span> <span class="o">=</span> <span class="n">ambient</span> <span class="o">+</span> <span class="n">attenuation</span><span class="o">*</span><span class="p">(</span><span class="n">diffuse</span> <span class="o">+</span> <span class="n">specular</span><span class="p">);</span>
    
    <span class="c1">//final color (after gamma correction)</span>
    <span class="k">vec3</span> <span class="n">gamma</span> <span class="o">=</span> <span class="k">vec3</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">2.2</span><span class="p">);</span>
    <span class="n">finalColor</span> <span class="o">=</span> <span class="k">vec4</span><span class="p">(</span><span class="n">pow</span><span class="p">(</span><span class="n">linearColor</span><span class="p">,</span> <span class="n">gamma</span><span class="p">),</span> <span class="n">surfaceColor</span><span class="p">.</span><span class="n">a</span><span class="p">);</span>
<span class="p">}</span>
</pre></div><p>There is a new uniform called <code>cameraPosition</code>, which is necessary to calculate the specular component. You may come across other fragment shaders that don't have the camera position as a uniform. If the lighting calculations are done in camera space, instead of world space, then the position of the camera is always the origin <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 3.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1003.02em, 2.555em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-144" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.159em;">0</span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27">(0,0,0)</script>. This is fairly common, but we'll continue to work in world space for the moment, because it's a bit more intuitive and similar to the code in the previous article.</p><p>There are two new elements of the <code>Light</code> struct: <code>attenuation</code> and <code>ambientCoefficient</code>. The <code>attenuation</code> variable is the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-150" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">k</script> value we saw in the attenuation section, earlier in the article. The <code>ambientCoefficient</code> variable is the percentage of the light to use for the ambient component, also explained earlier in this article.</p><p>There are new material uniforms:</p>
<div class="highlight"><pre><span class="k">uniform</span> <span class="k">sampler2D</span> <span class="n">materialTex</span><span class="p">;</span>
<span class="k">uniform</span> <span class="k">float</span> <span class="n">materialShininess</span><span class="p">;</span>
<span class="k">uniform</span> <span class="k">vec3</span> <span class="n">materialSpecularColor</span><span class="p">;</span>
</pre></div><p>The <code>materialTex</code> variable is the same as <code>tex</code> in previous articles, but has been renamed to fit in with the other material uniforms. The <code>materialShininess</code> variable is the specular exponent. The <code>materialSpecularColor</code> variable determines what light is absorbed and reflected in the specular calculation. Remember that the specular and diffuse colors are usually different. The diffuse color comes from the texture (<code>materialTex</code>), and the specular color comes from this <code>materialSpecularColor</code> variable.</p>
<div class="alert alert-info">
  <strong>Note:</strong> In a previous version of this article, the material
  uniforms were in a GLSL struct called <code>Material</code>. Unfortunately,
  GLSL 1.5 does not allow samplers (such as <code>materialTex</code>) inside
  structs, and some drivers would not compile the fragment shader.
</div><p>The <code>main</code> function of the shader starts by calculating a few variables, and then each paragraph of code corresponds to a section in this article:</p>
<ul>
  <li>Calculate the ambient component</li>
  <li>Calculate the diffuse component</li>
  <li>Calculate the specular component</li>
  <li>Calculate the attenuation</li>
  <li>Combine ambient, diffuse and specular components, with attenuation applied</li>
  <li>Perform gamma correction</li>
</ul><h2>C++ Code Changes</h2><p>Most of the changes in this article are in the fragment shader. The C++ changes are only there to set the new uniforms in the fragment shader.</p><p>The <code>ModelAsset</code> struct has new variables for shininess and specular color:</p>
<div class="highlight"><pre><span class="k">struct</span> <span class="n">ModelAsset</span> <span class="p">{</span>
    <span class="n">tdogl</span><span class="o">::</span><span class="n">Program</span><span class="o">*</span> <span class="n">shaders</span><span class="p">;</span>
    <span class="n">tdogl</span><span class="o">::</span><span class="n">Texture</span><span class="o">*</span> <span class="n">texture</span><span class="p">;</span>
    <span class="n">GLuint</span> <span class="n">vbo</span><span class="p">;</span>
    <span class="n">GLuint</span> <span class="n">vao</span><span class="p">;</span>
    <span class="n">GLenum</span> <span class="n">drawType</span><span class="p">;</span>
    <span class="n">GLint</span> <span class="n">drawStart</span><span class="p">;</span>
    <span class="n">GLint</span> <span class="n">drawCount</span><span class="p">;</span>
    <span class="n">GLfloat</span> <span class="n">shininess</span><span class="p">;</span> <span class="c1">//new this article</span>
    <span class="n">glm</span><span class="o">::</span><span class="n">vec3</span> <span class="n">specularColor</span><span class="p">;</span> <span class="c1">//new this article</span>
<span class="p">};</span>
</pre></div><p>The <code>Light</code> struct has new variables for attenuation and the ambient coefficient:</p>
<div class="highlight"><pre><span class="k">struct</span> <span class="n">Light</span> <span class="p">{</span>
    <span class="n">glm</span><span class="o">::</span><span class="n">vec3</span> <span class="n">position</span><span class="p">;</span>
    <span class="n">glm</span><span class="o">::</span><span class="n">vec3</span> <span class="n">intensities</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">attenuation</span><span class="p">;</span> <span class="c1">//new this article</span>
    <span class="kt">float</span> <span class="n">ambientCoefficient</span><span class="p">;</span> <span class="c1">//new this article</span>
<span class="p">};</span>
</pre></div><p>Inside <code>LoadWoodenCrateAsset</code> we set the new material variables:</p>
<div class="highlight"><pre><span class="n">gWoodenCrate</span><span class="p">.</span><span class="n">shininess</span> <span class="o">=</span> <span class="mf">80.0</span><span class="p">;</span>
<span class="n">gWoodenCrate</span><span class="p">.</span><span class="n">specularColor</span> <span class="o">=</span> <span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0f</span><span class="p">,</span> <span class="mf">1.0f</span><span class="p">,</span> <span class="mf">1.0f</span><span class="p">);</span>
</pre></div><p>A shininess value of 80 means the crates will be very shiny. The specular color is set to white, which is the most common specular color.</p><p>Inside <code>AppMain</code> we set the new light variables:</p>
<div class="highlight"><pre><span class="n">gLight</span><span class="p">.</span><span class="n">attenuation</span> <span class="o">=</span> <span class="mf">0.2f</span><span class="p">;</span>
<span class="n">gLight</span><span class="p">.</span><span class="n">ambientCoefficient</span> <span class="o">=</span> <span class="mf">0.005f</span><span class="p">;</span>
</pre></div><p>Setting the ambient coefficient to 0.005 means that the minimum brightness is 0.5% of the maximum brightness. This should make the back sides of the crates very dark, but not pure black. The attenuation variable doesn't have any specific value – I just played around with it until I found a value that looked good.</p><p>All of the new shader uniforms are set inside the <code>RenderInstance</code> function, like so:</p>
<div class="highlight"><pre><span class="c1">//set the shader uniforms</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"camera"</span><span class="p">,</span> <span class="n">gCamera</span><span class="p">.</span><span class="n">matrix</span><span class="p">());</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"model"</span><span class="p">,</span> <span class="n">inst</span><span class="p">.</span><span class="n">transform</span><span class="p">);</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"materialTex"</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"materialShininess"</span><span class="p">,</span> <span class="n">asset</span><span class="o">-&gt;</span><span class="n">shininess</span><span class="p">);</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"materialSpecularColor"</span><span class="p">,</span> <span class="n">asset</span><span class="o">-&gt;</span><span class="n">specularColor</span><span class="p">);</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"light.position"</span><span class="p">,</span> <span class="n">gLight</span><span class="p">.</span><span class="n">position</span><span class="p">);</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"light.intensities"</span><span class="p">,</span> <span class="n">gLight</span><span class="p">.</span><span class="n">intensities</span><span class="p">);</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"light.attenuation"</span><span class="p">,</span> <span class="n">gLight</span><span class="p">.</span><span class="n">attenuation</span><span class="p">);</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"light.ambientCoefficient"</span><span class="p">,</span> <span class="n">gLight</span><span class="p">.</span><span class="n">ambientCoefficient</span><span class="p">);</span>
<span class="n">shaders</span><span class="o">-&gt;</span><span class="n">setUniform</span><span class="p">(</span><span class="s">"cameraPosition"</span><span class="p">,</span> <span class="n">gCamera</span><span class="p">.</span><span class="n">position</span><span class="p">());</span>
</pre></div><p>There is also a small change to <code>tdogl/Texture.cpp</code> in order to undo the gamma correction on textures as they are loaded, explained earlier in the gamma correction section of this article. It now passes <code>GL_SRGB</code> instead of <code>GL_RGB</code> as the third argument to the <code>glTexImage2D</code> function. This will make OpenGL undo the gamma correction on the textures, so that we can redo the gamma correction later in the fragment shader.</p><h2>Future Article Sneak Peek</h2><p>In the next article we will implement directional lights and spotlights. We will also get multiple lights working at the same time.</p></div>

  <footer>
    <div class="alert alert-info subscribe-bait">
      <p><strong>Enjoy this post?</strong></p>
      <a class="btn btn-success" href="https://www.tomdalling.com/feed/">
        Subscribe via RSS
      </a>
      <iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-follow-button twitter-follow-button-rendered" style="position: static; visibility: visible; width: 162px; height: 28px;" title="Twitter Follow Button" src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/follow_button.d30011b0f5ce05b98f24b01d3331b3c1.en.html" data-screen-name="tom_dalling"></iframe>
      <script id="twitter-wjs" src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/widgets.js.下载"></script><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    </div>

    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script id="disqus_script" type="text/javascript">
      var disqus_shortname = "tomdalling";
      var disqus_identifier = "1282 http:\/\/tomdalling.com\/?p=1282";
      var disqus_title = "Modern OpenGL 07 \u2013 More Lighting: Ambient, Specular, Attenuation, Gamma";
      var disqus_url = "http:\/\/www.tomdalling.com\/blog\/modern-opengl\/07-more-lighting-ambient-specular-attenuation-gamma\/";

      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a></noscript>
  </footer>

</article></main>

        <div class="col-md-4 sidebar">

          <div class="panel panel-default">
            <div class="panel-heading">Subscribe</div>
            <ul class="list-group">
              <li class="list-group-item">
                <a href="https://www.tomdalling.com/blog/feed/">
                  <i class="fa fa-rss"></i> RSS
                </a>
              </li>
              <li class="list-group-item">
                <a href="https://twitter.com/tom_dalling">
                  <i class="fa fa-twitter"></i> Twitter
                </a>
              </li>
            </ul>
          </div>

          <div class="panel panel-default">
            <div class="panel-heading">Recent Posts</div>
            <ul class="list-group recent-posts">
              <li class="list-group-item">
                <a href="https://www.tomdalling.com/blog/ruby/pure-function-as-an-object-PFAAO-pattern/">The Pure Function As An Object (PFAAO) Ruby Pattern</a>
              </li><li class="list-group-item">
                <a href="https://www.tomdalling.com/blog/software-design/fizzbuzz-in-too-much-detail/">FizzBuzz In Too Much Detail</a>
              </li><li class="list-group-item">
                <a href="https://www.tomdalling.com/blog/ruby/fruity-bat-flappy-bird-clone-in-ruby/">Making Fruity Bat (a Flappy Bird clone) in Ruby</a>
              </li><li class="list-group-item">
                <a href="https://www.tomdalling.com/blog/modern-opengl/08-even-more-lighting-directional-lights-spotlights-multiple-lights/">Modern OpenGL 08 – Even More Lighting: Directional Lights, Spotlights, &amp; Multiple Lights</a>
              </li><li class="list-group-item">
                <a href="https://www.tomdalling.com/blog/modern-opengl/opengl-in-2014/">OpenGL in 2014</a>
              </li>
            </ul>
          </div>

          <div class="panel panel-default">
            <div class="panel-heading">Blog Categories</div>
            <ul class="list-group categories">
              <li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/cocoa/">Cocoa</a>
                (<span class="post-count">5</span>
                <a href="https://www.tomdalling.com/blog/category/cocoa/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li><li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/coding-styleconventions/">Coding Style/Conventions</a>
                (<span class="post-count">3</span>
                <a href="https://www.tomdalling.com/blog/category/coding-styleconventions/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li><li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/coding-tips/">Coding Tips</a>
                (<span class="post-count">4</span>
                <a href="https://www.tomdalling.com/blog/category/coding-tips/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li><li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/random-stuff/">Miscellaneous</a>
                (<span class="post-count">1</span>
                <a href="https://www.tomdalling.com/blog/category/random-stuff/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li><li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/modern-opengl/">Modern OpenGL Series</a>
                (<span class="post-count">10</span>
                <a href="https://www.tomdalling.com/blog/category/modern-opengl/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li><li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/ruby/">Ruby</a>
                (<span class="post-count">2</span>
                <a href="https://www.tomdalling.com/blog/category/ruby/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li><li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/software-design/">Software Design</a>
                (<span class="post-count">9</span>
                <a href="https://www.tomdalling.com/blog/category/software-design/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li><li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/software-processes/">Software Processes</a>
                (<span class="post-count">1</span>
                <a href="https://www.tomdalling.com/blog/category/software-processes/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li><li class="list-group-item">
                <a class="category" href="https://www.tomdalling.com/blog/category/web/">Web</a>
                (<span class="post-count">1</span>
                <a href="https://www.tomdalling.com/blog/category/web/feed/" class="feed"><i class="fa fa-rss"></i></a>)
              </li>
            </ul>
          </div>

          <div class="panel panel-default">
            <div class="panel-heading">Blog Archives</div>
            <ul class="list-group archives">
              <li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2016/02/">February 2016</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2015/04/">April 2015</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2015/02/">February 2015</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2014/11/">November 2014</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2014/09/">September 2014</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2014/02/">February 2014</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2013/04/">April 2013</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2013/03/">March 2013</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2013/02/">February 2013</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2013/01/">January 2013</a>
                (<span class="post-count">2</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2012/12/">December 2012</a>
                (<span class="post-count">2</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2012/11/">November 2012</a>
                (<span class="post-count">2</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2012/07/">July 2012</a>
                (<span class="post-count">2</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2012/05/">May 2012</a>
                (<span class="post-count">2</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2012/03/">March 2012</a>
                (<span class="post-count">2</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2011/12/">December 2011</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2010/12/">December 2010</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2010/11/">November 2010</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2010/05/">May 2010</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2010/04/">April 2010</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2010/02/">February 2010</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2009/12/">December 2009</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2009/11/">November 2009</a>
                (<span class="post-count">3</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2009/10/">October 2009</a>
                (<span class="post-count">2</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2009/07/">July 2009</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2009/06/">June 2009</a>
                (<span class="post-count">1</span>)
              </li><li class="list-group-item">
                <a class="month" href="https://www.tomdalling.com/blog/2009/05/">May 2009</a>
                (<span class="post-count">1</span>)
              </li>
            </ul>
          </div>

        </div>
      </div>

      <footer class="page-footer">
        <p>© 2009 – <span class="current-year">2016</span> Tom Dalling</p>

        <p class="social">
          <a href="https://twitter.com/tom_dalling">
            <i class="fa fa-lg fa-twitter"></i>
          </a>
          <a href="https://github.com/tomdalling">
            <i class="fa fa-lg fa-github"></i>
          </a>
          <a href="https://stackoverflow.com/users/108105/tom-dalling">
            <i class="fa fa-lg fa-stack-overflow"></i>
          </a>
          <a href="mailto:tom%20at%20tomdalling%20com">
            <i class="fa fa-lg fa-envelope"></i>
          </a>
        </p>
      </footer>

      <script src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/all.js.下载"></script>
      <script type="text/x-mathjax-config;executed=true">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [['$$','$$']],
            displayMath: [['[blockmath]', '[/blockmath]']]
          }
        });
      </script>
      <script src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/MathJax.js.下载" id=""></script>
    </div>

<iframe scrolling="no" frameborder="0" allowtransparency="true" src="./Modern OpenGL 07 – More Lighting_ Ambient, Specular, Attenuation, Gamma — Tom Dalling_files/widget_iframe.d30011b0f5ce05b98f24b01d3331b3c1.html" title="Twitter settings iframe" style="display: none;"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Math-italic, sans-serif;"></div></div></body></html>